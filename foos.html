<!DOCTYPE html>
<html>
<head>
	<title>Foos</title>
	<style>
		body { font-family:monospace; font-size:8pt; }
		a { text-decoration:none; color:#66A; }
		.hide { display:none; }
	</style>
	<script src="jquery-1.6.2.min.js"></script>
	<script src="foos.js"></script>
	<script>
		var token;
		var teams;
		
		var score = function(team) {
			var pl = $("#player").val();
			
			// random position
			var pos = Math.random() > 0.5 ? "A" : "B";
			pos += Math.floor(Math.random()*11);
			
			Foos.score(token, team, pl, pos, function(game) {
				var score = Foos.getScore(game);
				$("#status").text(score[0] + " - " + score[1]);
				$("#scores").empty();
				for (score_pos in game.scores) {
					var score = game.scores[score_pos];
					$("#scores").append('<p>Score team:' + score.team + ' player:' + score.player + ' from:' + score.position + ' own:' + Foos.isSelfGoal(game, score) + '</p>');
				}
			});
			
		};
		
		$(function() {
			$("#game").click(function() {
				
				Foos.game([
					["Rouzbeh", "Josh"],
					["Joakim", "Jesper"]
				], function(gameToken) {
					token = gameToken;
					Foos.getGame(gameToken, function(game){
						teams = game.teams;
						
						$("#player").empty();
						for (t in teams)
							for (p in teams[t])
								$("#player").append('<option value="' + teams[t][p] + '">' + teams[t][p] + '</select>')
						
						$("#teams").text(gameToken + ' ' + JSON.stringify(game.teams));
						$("#scores").empty();
						$("#status").text("...");
						$("#gamepan").removeClass("hide");
					});
				});
				
			});
			$("#score0").click(function() { score(0); });
			$("#score1").click(function() { score(1); });
		});
	</script>
</head>
<body>
	<h2><a href="#" id="game">new game</a></h2>
	<p><div id="teams">...</div></p>
	<div id="gamepan" class="hide">
		<select id="player"></select></br>
		<a href="#" id="score0">score team 0</a></br>
		<a href="#" id="score1">score team 1</a>
		<p><div id="status">...</div></p>
		<p><div id="scores">...</div></p>
	</div>
</body>
</html>