
<html>
    <head>
        <title>VP BoT pOkEr</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">

        <script type="text/javascript" src="jquery-1.6.2.min.js"></script>
        <script type="text/javascript" src="jquery-ui-1.8.10.custom.min.js"></script>
        <script type="text/javascript">
            //
var gid = -1;
var players = [
          {
           "name":"Rouzbeh",
           "url":"http://mdb2.ibibo.com/09053616c7465645f5f3dec2fdffe3320ab090c4b507431c7333127093674e64add2c683a5e91b2fa88ea6744da1622a1ccb1c694.jpeg/foosball-snooker-player-feed-b.jpeg"
          },
          {
           "name":"Josh",
           "url":"http://mdb2.ibibo.com/09053616c7465645f5f3dec2fdffe3320ab090c4b507431c7333127093674e64add2c683a5e91b2fa88ea6744da1622a1ccb1c694.jpeg/foosball-snooker-player-feed-b.jpeg"
          },
          {
           "name":"Joakim",
           "url":"http://mdb2.ibibo.com/09053616c7465645f5f3dec2fdffe3320ab090c4b507431c7333127093674e64add2c683a5e91b2fa88ea6744da1622a1ccb1c694.jpeg/foosball-snooker-player-feed-b.jpeg"
          },
          {
           "name":"Jesper",
           "url":"http://mdb2.ibibo.com/09053616c7465645f5f3dec2fdffe3320ab090c4b507431c7333127093674e64add2c683a5e91b2fa88ea6744da1622a1ccb1c694.jpeg/foosball-snooker-player-feed-b.jpeg"
          },
];

var game ={
	"teams":[
            /* e.g.
		["Rouzbeh", "Josh"],
		["Joakim", "Jesper"]
            */
	],
	"score": [0,0]
	/*scores: [
		{
			team: <0|1>,
			player: "<player",
			position: <plastic-man-position>
		},
		{
			team: <0|1>,
			player: "<player",
			position: <plastic-man-position>
		}
	]*/
};

var Foos = {
     game : function(){
     },
     score : function(token, team, player, plastic_man, callback){
         game.score[team]++;
         callback(game);
     }
};

var switchSides = function() {
    players = [players[3], players[2], players[1], players[0]];
};

var endGame = function() {
    var winning_team = game.score[0] == 10 ? 0 : 1;
    alert(game.teams[winning_team][0] + " and " + game.teams[winning_team][1] + " won!");
}

var updateDisplay = function(){

    $.each(players, function(i){
        $("div#player" + (i+1)).html(this.name);
    });

    $('#scoreboard').html(game.score[0] + ' - ' + game.score[1]);
}

var getTeam = function(name){
    for (var team = 0; team < game.teams.length; team++) {
        for (var i = 0; i < game.teams[team].length; i++) {
            if (name == game.teams[team][i]) {
                return team;
            }
        }
    }
};

$(document).ready(function () {
        
        updateDisplay();

        $("#start-game").click(function(){
            game.teams = [
                [players[0].name, players[1].name],
                [players[2].name, players[3].name],
            ];
            Foos.game(game.teams, function(game_token) {
                gid = game_token;
            });
            $('.player_position').fadeIn();
            $(this).hide();
        });

        $('div.player_position').click(function(){
            var player = $(this).html(); // FIXME
            Foos.score(gid, getTeam(player), player, null, function(game_state){
                game = game_state;
                if(game.score[getTeam(player)] == 5 && game.score[getTeam(player)? 0 : 1]<5)
                {
                    switchSides();
                } else if (game.score[0] == 10 || game.score[1] == 10) {
                    endGame();
                }

                updateDisplay();
            });
        });
});

        </script>
        <style type="text/css">

            img{
                height: 50px;
                width: 30px;
}
.player_position{
    background-color: gray;
    height: 100px;
    width: 100px;
    float: left;
    margin: 1px;
    text-align: center;
    cursor: pointer;
    display: none;
}
.player_position:hover{
    background-color: green;
}
#scoreboard {
    float: left;
}

        </style>
    </head>

<body>
    <div id="scoreboard">0 - 0</div> <br/>
    <div id="table">

        

        <div class="player_position" id="player1">
        </div>
        <div class="player_position" id="player2">
        </div>
        <br/>  <br/>  <br/>  <br/>  <br/>  <br/>
        <div class="player_position" id="player4">
        </div>
        <div class="player_position" id="player3">
        </div>
    </div>
    <div style="clear: left;"><button id="start-game">Start Game</button></div>
</body>
</html>